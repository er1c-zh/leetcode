#
# @lc app=leetcode.cn id=421 lang=ruby
#
# [421] 数组中两个数的最大异或值
#

# @lc code=start
# @param {Integer[]} nums
# @return {Integer}
class ENode
    def initialize()
      @val = nil
      @children = Array.new(2){nil}
      @cnt = 0 # 此节点下的数量
    end
  
    attr_accessor :val, :children, :cnt
    def add(val, idx)
        if idx < 0
            @val = val
            @cnt = 1
            return
        end
        @cnt += 1
        toIdx = (val >> idx) & 0b1 == 0 ? 0 : 1
        if @children[toIdx] == nil
            @children[toIdx] = ENode.new
        end
        @children[toIdx].add(val, idx - 1)
    end
    def find(val, idx, cur)
        if @cnt == 0
            puts "unexpected"
            return false
        end
        if idx < 0
            return @val ^ val
        end
        # 先尝试找自己需要的，然后在尝试找下一个
        cur_bit = (cur >> idx) & 0b1
        val_bit = (val >> idx) & 0b1
        good = val_bit == 0 ? 1 : 0
        bad = val_bit
        if @children[good] != nil
            if cur_bit == 0
                # cur已经小了
                cur = 0
            end
            return @children[good].find(val, idx - 1, cur)
        end
        if cur != nil && cur_bit == 1 
            # cur一定大
            return cur
        end
        return @children[bad].find(val, idx - 1, cur)
    end
end
def find_maximum_xor(nums)
    trie = ENode.new
    result = 0
    nums.each{
        |v|
        trie.add(v, 32)
        result = trie.find(v, 32, result)
        # if result == nil || v ^ _v > result
        #     result = v ^ _v
        # end
    }
    return result
end
# @lc code=end

if __FILE__ == $0
    puts "#{find_maximum_xor [3,10,5,25,2,8]}"
    puts "#{find_maximum_xor [0]}"
    puts "#{find_maximum_xor [2,4]}"
    puts "#{find_maximum_xor [8,10,2]}"
    puts "#{find_maximum_xor [14,70,53,83,49,91,36,80,92,51,66,70]}"
    puts "#{find_maximum_xor [10821,6050,496,28672,19835,1567,22346,9996,8028,15882,24693,328,20711,1623,4563,13078,25470,9536,14167,29134,24587,27257,1855,23769,6939,25531,31485,27429,18341,27286,8511,32139,31683,16009,13859,27814,28582,29919,17256,25675,23862,26126,16430,31139,8646,9503,3009,22969,19929,22066,3385,10740,10302,25979,24242,3543,15664,17755,820,31666,9982,1358,5188,1449,25537,2658,31377,22002,13865,5324,4740,23831,4837,22476,9624,17146,16677,3416,6831,18582,31780,10886,19463,15530,16146,11878,31284,7208,26284,28664,16875,19154,11378,14023,28654,27544,19109,28782,5556,19849,26557,31140,11172,4659,24070,14287,10985,17101,23323,13618,4850,1049,17670,25871,32242,22711,19859,20313,30653,31828,24194,30746,25339,21861,28288,19376,27068,15115,10936,13723,17305,13543,14114,22277,14337,27325,27470,27488,29784,27374,5181,17668,18510,4244,849,24679,27790,17058,18163,30179,26419,26079,16133,13097,27837,8790,21832,17503,20280,26989,6706,10602,31009,211,8219,10910,20622,17861,18470,31026,32084,29130,27900,25348,302,6812,11519,19718,22380,10885,5538,2479,9575,20981,5256,18642,4546,11714,13363,26411,11368,11446,9056,16668,26642,27234,11249,1330,20098,13910,20150,26886,25276,17876,22406,32278,20543,3142,9980,30314,12286,27726,9121,20046,32600,25764,27172,2202,32162,13446,23391,2635,24718,31064,8478,31146,28392,27178,24909,13736,31165,324,14643,19424,4630,11513,20010,11224,14507,3096,4996,23746,22534,21191,2859,12301,6827,21435,22445,14268,30299,12301,5995,13010,25166,32188,6603,2979,17460,16312,20523,32262,4723,22937,3504,14886,21550,20916,10493,5604,20792,20091,3543,17226,14560,5898,17677,11650,13176,32195,4956,14525,25803,729,9481,30387,27878,13413,872,24452,858,25530,21732,29919,27189,11574,28451,2556,21994,1775,28435,11953,27161,13142,30403,31847,10035,18185,9091,14200,30721,23510,6675,24868,28087,1623,31707,23083,14550,5867,13463,28526,12301,11886,14912,270,9123,23711,24025,2067,4073,20835,16534,19141,7258,30186,30599,5461,7638,11471,15197,24023,10174,6799,9800,31130,29785,6524,13307,7712,24733,27355,7720,30387,23316,2865,9245,7360,2596,15535,1208,15482,32268,8502,18458,29670,9687,16668,11681,20650,20176,15053,17458,200,25120,16675,16617,8633,29884,24830,31124,20863,15680,26354,9804,25424,24761,14229,10226,9833,28905,10550,6634,764,15280,27164,30817,18861,31027,16372,8404,6651,13218,26753,31684,27053,19063,10406,31666,3465,3888,23413,3444,30415,10346,32120,1426,32578,25234,18440,31441,7458,6314,20881,27124,20805,16358,31551,32452,25527,9553,30739,11004,10009,17480,26560,24249,22867,6019,12271,7564,19128,32308,19997,18411,25474,1648,10048,6394,20776,4318,12154,22059,21886,10808,6813,22390,802,21878,77,9553,27053,2684,1382,10685,23879,19189,29391,9991,19658,28984,14682,21180,11620,4294,6017,21640,11598,13084,7345,1896,12227,10122,13958,21772,7722,32314,18148,26674,22402,8299,1138,3073,15826,7985,11240,14101,767,21280,4628,4060,32751,5533,2794,29829,29198,5357,29359,24906,24278,23250,29427,15681,30802,18515,2537,3971,10967,3236,3760,3164,2210,4901,29595,1091,30581,18086,412,23916,2335,27112,25124,8474,23467,4635,2423,29201,405,15810,8730,3077,19023,31351,12716,10093,29065,25042,32197,17948,8605,29672,25839,1827,28624,30177,22158,12681,3457,23598,20369,7852,4655,13960,15476,1135,24333,28856,17076,3172,25966,32394,9431,25423,29047,20967,12699,4058,19894,25597,30989,22839,1603,9306,19148,3086,29773,2819,8941,31750,190,21408,13834,22895,16036,21585,26792,20597,331,4437,19872,28201,19686,24130,24343,20016,12325,8918,13364,2785,18389,32100,15949,13272,14688,2835,10267,938,15968,23356,8480,14921,23456,8649,13639,20131,23609,23059,14108,31569,23494,14998,30889,7286,19365,11809,1652,5432,9222,1545,17387,8070,14480,15810,22778,20415,1190,25232,27888,27585,11979,19815,28292,20562,27537,20136,22936,19567,31940,32385,2179,7653,10864,17265,29946,20144,30100,19521,4071,22396,21589,31300,9108,3945,26357,17359,10601,29893,17011,21945,12801,4252,11519,32109,25331,14404,23926,22588,28816,984,12841,12519,6602,24196,5636,25762,18840,17326,14070,24846,26366,4381,32023,20487,12598,24766,6545,22619,28228,30232,20616,14905,11826,9830,29780,7546,25211,5614,7809,7659,13976,8645,31695,7555,28376,29347,26880,19922,7621,30022,7591,127,25119,8539,23622,19588,29744,28455,11047,21600,16843,22336,10955,20659,23376,19132,12275,1741,30292,32750,32331,21001,30088,9593,19622,21601,19000,29200,19076,1575,15741,11586,26721,29619,18022,23486,18107,12897,31828,2730,30512,1667,13192,24748,26892,17451,10779,30778,27349,17382,9470,28628,12413,13530,12892,9369,9184,26866,32462,28208,8124,17804,10900,18838,27357,22459,25265,30434,11818,24903,12011,20899,21551,31106,21860,6870,8186,10256,19644,142,12590,19634,2380,8722,14854,14073,24497,16777,23974,3718,27398,842,18508,27666,15040,20900,29729,21591,2853,31669,2774,6605,12881,19991,27090,20725,18990,7377,8949,17318,9782,21144,30197,21847,3981,15663,21092,9072,32718,19198,8198,25528,9655,6165,2032,20055,28596,5012,11079,15446,1162,30351,8107,8569,29273,31462,7492,20741,7107,10037,29994,30649,7760,23965,19002,22473,15207,12793,7660,31639,22000,18884,23270,21719,30288,17027,8943,26970,12352,19881,12907,16311,6034,26554,16364,12323,12397,4735,16183,9540,26656,17063,23786,18923,18082,15786,14862,1670,21270,20633,24482,13370,27767,16350,7826,4584,23125,27183,19597,14310,25585,20667,18349,16200,12247,8885,32632,26336,6926,8305,15328,23887,25419,23010,27295,3305,27350,26205,21091,6840,20220,9228,27507,14607,16146,32516,694,4020,12982,21563,10405,32669,16081,21437,30880,19048,31377,23417,31310,2695,9654,16326,9486,24177,14291,3266,10391,19760,189,2733,20560,29572,10980,13314,14316,15209,13636,31655,3602,9336,23595,242,22083,17016,27293,18377,19605,32095,17385,15168,26075,26115,26388,5259,16573,22295,24277,26627,4865,23207,6886,22426,1496,25084,25197,27341,2849,26045,2782,21006,5108,23835,3794,20679,44,22596,19211,25158,31123,5240,25681,32549,31710,21256,30414,1864,11921,23694,7677,25523,23136,5428,15303,13275,31013,24148,1962,19986,26045,3510,15845,17232,19451,24623,15081,24695,23737,28053,247,31773,18011,21505,18536,8296,16831,11602,9414,13064,18158,24053,521,32405,1635,3695,3993,16476,31082,20193,9783,24262,14618,13965,28060,25451,21964,25014,488,28552,16883,1295,23085,7920,9520,14907,32290,27303,17135,15024,22075,20966,12333,24091,19414,21800,30067,17690,9908,30707,1779,17560,512,5293,16466,3167,22321,31571,27784,11166,3598,19690,13430,25282,17009,19344,30035,16791,26287,21291,12289,15510,9049,18582,12862,6263,12819,12552,26942,15130,18693,18381,3345,8305,12775,6719,29624,16199,25670,15203,16248,15154,26689,6327,28015,28698,29328,5561,3706,11942,3420,30525,19869,868,31229,12945,21334,22355,20238,10305,11585,20341,32360,12625,2303,14111,11455,30591,32138,28347,31751,28586,15762,9896,20977,23068,8594,14535,32034,16326,5210,1934,17112,6758,4299,19732,13199,25034,30823,5117,7331,18562,9249,23177,16146,13415,28232,22473,20962,22534,12835,22934,7266,2186,5131,28898,19168,26518,24589,18490,1163,31083,9059,29349,11409,18365,29295,14636,13139,15214,174,10047,6141,27620,3375,10862,11363,3254,24991,15740,28,5365,26283,5644,25163,4755,5088,9384,23811,23462,23110,4402,21871,31920,6638,9487,14766,22728,24632,28708,1888,3804,22016,4616,5027,10812,3683,15868,28736,15931,23384,25859,29385,28760,24544,25822,25989,9288,23556,19352,30508,11721,21126,5544,26140,15938,12368,13952,542,6749,28288,2048,12033,24101,2467,31526,29160,16310,342,23996,30635,604,1430,23218,11903,22376,13272,29202,18448,3723,24949,14271,19989,26086,14676,19675,3343,31478,10061,24413,10321,20985,12597,2395,30894,20247,26780,25687,8032,19152,2535,10542,11920,6374,215,10248,17849,20386,30289,23862,4342,31793,13768,32405,15505,9752,19717,30411,24124,13691,17468,4141,22213,30255,8324,22445,27063,1556,3104,24096,24200,32072,1096,23509,30064,7600,6650,29725,932,12745,29246,32140,30128,13470,10781,11566,6162,17610,20290,32595,4189,28646,14873,20414,18760,17649,25117,16074,15133,8126,456,321,25834,29915,27822,14522,6745,6261,21929,10333,29138,11379,19483,20694,10676,9579,17166,12169,22333,14460,27,25395,23279,27000,20157,13500,6463,19492,31341,19959,18065,8289,7771,7373,31739,496,8042,26871,16306,30358,20221,19512,23066,14125,19172,3410,2180,14306,14312,25891,6925,19693,10507,7594,25231,25010,8054,7699,31718,14658,4634,4940,22744,31441,30294,21581,29146,8603,12386,17814,4171,21808,29135,16875,30808,5498,19375,29883,7680,13375,28679,20795,15600,18033,32229,28287,12545,28226,24850,18806,32743,12269,210,11288,13729,2972,23113,4314,13902,21705,12961,5719,31458,29894,14496,10915,24213,27692,28059,15557,28411,27665,5210,20154,20523,7816,1770,22452,7097,25692,17448,28103,24866,23704,10067,30195,29475,4265,1329,8394,15271,22196,18728,502,12242,16705,30546,32489,26707,2032,10488,14352,6620,8744,20316,5016,30527,32238,14909,6862,16020,9463,5167,27864,14081,18572,7455,15871,5546,22947,30315,14883,10458,31556,8354,4473,31895,15916,12754,15947,22835,9243,6653,25830,32504,7453,24855,6254,21292,29708,14109,31438,5106,2399,8964,26657,2500,21260,7492,31708,3884,18322,28990,786,14521,19788,3999,10888,24715,7688,6370,6418,32218,29807,10768,21739,23727,11406,10942,30502,9739,15293,4119,24319,28960,10922,13187,24390,26854,23143,31814,25278,30928,22448,1848,3240,30607,15763,14399,22462,4896,11345,14962,15259,7934,16060,31003,17839,8339,9402,26304,32309,31086,1157,11723,16134,17779,29625,13053,12953,18625,26532,27248,32245,6621,3327,11058,23952,8750,15866,5712,24339,2356,15134,30030,30195,29872,5980,22698,29656,31447,2675,32630,25808,29096,31938,11741,10708,8425,213,21993,31596,13745,4870,17501,6094,6397,25654,13824,22229,20532,363,28005,14759,1888,30987,8644,28451,10683,16137,17922,9455,24700,15025,1978,11959,21828,15917,11138,30188,4668,18897,9341,4761,21905,8272,16066,22358,22986,10955,1735,14249,3902,7834,1581,11366,3095,27451,10792,24829,18955,16287,19014,7257,22287,16170,19691,29003,15813,15400,10469,3217,27683,12802,16646,29486,20687,29087,17059,13631,9304,25423,30184,18842,17639,26248,21372,10189,32209,25911,23735,23413,20244,9636,13648,5343,7375,27572,8566,29125,1060,20029,29075,17875,22258,7715,32176,13184,1133]}"
    # puts "#{find_maximum_xor []}"
end
